ggplot(data = ad_pie, aes(x = factor(1), y = Share, fill = Company)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y")
ggplot(data = ad_pie, aes(x = factor(1), y = Share, fill = Company)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") + xlab("") + ylab("") + labs(fill = "Company")
ggplot(data = ad_pie, aes(x = factor(1), y = Share, fill = Company)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") + xlab("") + ylab("")
ad_pie <- data.frame(Company = c("Google", "Facebook", "Yahoo", "AOL", "Other"),
Share = c(0.1, 0.019, 0.015, 0.006, 0.026))
ad_pie$Share <- ad_pie$Share * 171050
ggplot(data = ad_pie, aes(x = factor(1), y = Share, fill = Company)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") + xlab("") + ylab("")
ad_pie <- data.frame(Company = c("Yahoo", "Google", "Facebook", "AOL", "Other"),
Share = c(0.015, 0.1, 0.019, 0.006, 0.026))
ad_pie$Share <- ad_pie$Share * 171050
ggplot(data = ad_pie, aes(x = factor(1), y = Share, fill = factor(Company)) +
geom_bar(stat = "identity", width = 2) +
coord_polar(theta = "y") + xlab("") + ylab("")
)
ggplot(data = ad_pie, aes(x = factor(1), y = Share, fill = factor(Company))) +
geom_bar(stat = "identity", width = 2) +
coord_polar(theta = "y") + xlab("") + ylab("")
View(ad_pie)
ggplot(data = ad_pie, aes(x = factor(1), y = Share, fill = factor(Company))) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") + xlab("") + ylab("") + labs(fill = "Company")
ggplot(data = ad_pie, aes(x = factor(1), y = Share, fill = factor(Company))) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") + xlab("") + ylab("") +
scale_fill_discrete(breaks = levels(ad_pie$Company))
levels(ad_pie$Company)
ggplot(data = ad_pie, aes(x = factor(1), y = Share, fill = factor(Company))) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") + xlab("") + ylab("") +
scale_fill_discrete(breaks = c("Yahoo", "Google", "Facebook", "AOL", "Other"))
levels(ad_pie$Company) <- c("Yahoo", "Google", "Facebook", "AOL", "Other")
levels(ad_pie$Company)
ggplot(data = ad_pie, aes(x = factor(1), y = Share, fill = factor(Company))) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") + xlab("") + ylab("")
ad_pie$Share <- ad_pie$Share / sum(ad_pie$Share)
View(ad_pie)
ad_pie <- data.frame(Company = c("Yahoo", "Google", "Facebook", "AOL", "Other"),
Share = c(0.015, 0.1, 0.019, 0.006, 0.026))
View(ad_pie)
levels(ad_pie$Company)
ad_pie <- data.frame(Company = factor(c("Yahoo", "Google", "Facebook", "AOL", "Other")),
Share = c(0.015, 0.1, 0.019, 0.006, 0.026))
View(ad_pie)
levels(ad_pie$Company)
ad_pie <- data.frame(Company = c("Yahoo", "Google", "Facebook", "AOL", "Other"),
Share = c(0.015, 0.1, 0.019, 0.006, 0.026))
View(ad_pie)
ad_pie$Share <- ad_pie$Share / sum(ad_pie$Share)
View(ad_pie)
ad_pie$Share <- round(ad_pie$Share / sum(ad_pie$Share) * 100, 2)
View(ad_pie)
ad_pie <- data.frame(Company = c("Yahoo", "Google", "Facebook", "AOL", "Other"),
Share = c(0.015, 0.1, 0.019, 0.006, 0.026))
ad_pie$Share <- round(ad_pie$Share / sum(ad_pie$Share) * 100, 2)
View(ad_pie)
levels(ad_pie$Company)
levels(ad_pie$Company) <- c("Yahoo", "Google", "Facebook", "AOL", "Other")
View(ad_pie)
ad_pie <- data.frame(Company = c("Yahoo", "Google", "Facebook", "AOL", "Other"),
Share = c(0.015, 0.1, 0.019, 0.006, 0.026))
ad_pie$Share <- round(ad_pie$Share / sum(ad_pie$Share) * 100, 2)
ggplot(data = ad_pie, aes(x = factor(1), y = Share, fill = factor(Company))) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") + xlab("") + ylab("")
ad_pie <- data.frame(Company = c("Yahoo", "Google", "Facebook", "AOL", "Other"),
Share = c(0.015, 0.1, 0.019, 0.006, 0.026))
ad_pie$Company <- factor(ad_pie$Company, levels = c("Yahoo", "Google", "Facebook", "AOL", "Other"))
ad_pie$Share <- round(ad_pie$Share / sum(ad_pie$Share) * 100, 2)
View(ad_pie)
leves(ad_pie$Comapny)
levels(ad_pie$Company)
ggplot(data = ad_pie, aes(x = factor(1), y = Share, fill = factor(Company))) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") + xlab("") + ylab("") + labs(fill = "Company")
ggplot(data = ad_pie, aes(x = factor(1), y = Share, fill = factor(Company))) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") + xlab("") + ylab("") +
labs(fill = "Company") +
theme(text = element_text(size = 20))
ggplot(data = ad_pie, aes(x = "", fill = factor(Company))) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
labs(fill = "Company") +
theme(text = element_text(size = 20))
ggplot(data = ad_pie, aes(x = "", fill = factor(Company))) +
geom_bar(width = 1) +
coord_polar(theta = "y") +
opts(axis.title.x = theme_blank(), axis.title.y = theme_blank())
labs(fill = "Company") +
theme(text = element_text(size = 20))
ggplot(data = ad_pie, aes(x = "", fill = factor(Company))) +
geom_bar(width = 1) +
coord_polar(theta = "y") +
labs(fill = "Company") +
theme(text = element_text(size = 20),
axis.title.x = theme_blank(), axis.title.y = theme_blank())
ggplot(data = ad_pie, aes(x = "", fill = factor(Company))) +
geom_bar(width = 1) +
coord_polar(theta = "y") +
labs(fill = "Company") +
theme(text = element_text(size = 20),
axis.title.x = element_blank(), axis.title.y = element_blank())
ggplot(data = ad_pie, aes(x = factor(1), y = Share, fill = factor(Company))) +
geom_bar(width = 1) +
coord_polar(theta = "y") +
labs(fill = "Company") +
theme(text = element_text(size = 20),
axis.title.x = element_blank(), axis.title.y = element_blank())
ggplot(data = ad_pie, aes(x = factor(1), y = Share, fill = factor(Company))) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
labs(fill = "Company") +
theme(text = element_text(size = 20),
axis.title.x = element_blank(), axis.title.y = element_blank())
ggplot(data = ad_pie, aes(x = factor(1), y = Share, fill = factor(Company))) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
labs(fill = "Company") +
theme(text = element_text(size = 20))
ggplot(data = ad_pie, aes(x = factor(1), y = Share, fill = factor(Company))) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
labs(fill = "Company") +
theme(text = element_text(size = 20),
axis.title.x = element_blank(), axis.title.y = element_blank())
ad_share <- data.frame(Year = seq(2012, 2018, 1))
View(ad_share)
ad_share$TV <- c(39.1, 38.8, 38.1, 37.3, 36.9, 36.2, 35.7)
ad_share$Digital <- c(19.7, 19.5, 18.4, 16.9, 14.5, 12.7, 10.9)
ad_share$Mobile <- c(2.6, 5.7, 9.8, 14.0, 18.7, 22.6, 26.4)
ad_share$Newspapers <- c(11.5, 10.2, 9.3, 8.6, 8.0, 7.5, 7.1)
ad_share$Magazines <- c(9.2, 8.8, 8.4, 7.9, 7.5, 7.2, 6.9)
ad_share$Radio <- c(9.3, 8.9, 8.6, 8.2, 7.8, 7.5, 7.1)
ad_share$Outdoor <- c(4.0, 4.1, 4.0, 3.9, 3.8, 3.7, 3.6)
ad_share$Directories <- c(4.5, 4.0, 3.5, 3.1, 2.8, 2.5, 2.3)
ad_share_melt <- melt(ad_share, id = "Year", measure.vars = c("TV",
"Digital",
"Mobile",
"Newspapers",
"Magazines",
"Radio",
"Outdoor",
"Directories"))
View(ad_share_melt)
ad_share$Digital_non-mobile <- c(19.7, 19.5, 18.4, 16.9, 14.5, 12.7, 10.9)
ad_share$Digital_non_mobile <- c(19.7, 19.5, 18.4, 16.9, 14.5, 12.7, 10.9)
ad_share_melt <- melt(ad_share, id = "Year", measure.vars = c("TV",
"Digital_non_mobile",
"Mobile",
"Newspapers",
"Magazines",
"Radio",
"Outdoor",
"Directories"))
View(ad_share_melt)
colnames(ad_share_melt)[2] <- "Media"
View(ad_share_melt)
ggplot(data = ad_share_melt, aes(x = Year, y = value, group = Media,
shape = Media, color = Media)) +
geom_line(size = 1) +
geom_point(size = 3) +
xlab("Year") +
ylab("US total media ad spending share (%)") +
theme(text = element_text(size = 20))
ggplot(data = ad_share_melt, aes(x = Year, y = value, group = Media, color = Media)) +
geom_line(size = 1) +
geom_point(size = 3) +
xlab("Year") +
ylab("US total media ad spending share (%)") +
theme(text = element_text(size = 20))
ad_rev <- data.frame(year = seq(from = 2009, to = 2013, by = 1))
ad_rev[ad_rev$year == 2011, "yahoo_own"] <- 1998312 + 1056053
ad_rev[ad_rev$year == 2012, "yahoo_own"] <- 1930234 + 1206209
ad_rev[ad_rev$year == 2013, "yahoo_own"] <- 1744130 + 1371134
ad_rev[ad_rev$year == 2011, "yahoo_aff"] <- 161997 + 797057
ad_rev[ad_rev$year == 2012, "yahoo_aff"] <- 212584 + 679651
ad_rev[ad_rev$year == 2013, "yahoo_aff"] <- 205700 + 370657
ad_rev[ad_rev$year == 2009, "yahoo"] <- 1866984 + 3396396
ad_rev[ad_rev$year == 2010, "yahoo"] <- 2154886 + 3161589
ad_rev[ad_rev$year == 2011, "yahoo"] <- 2160309 + 1853110
ad_rev[ad_rev$year == 2012, "yahoo"] <- ad_rev[ad_rev$year == 2012, "yahoo_own"] + ad_rev[ad_rev$year == 2012, "yahoo_aff"]
ad_rev[ad_rev$year == 2013, "yahoo"] <- ad_rev[ad_rev$year == 2013, "yahoo_own"] + ad_rev[ad_rev$year == 2013, "yahoo_aff"]
ad_rev[ad_rev$year == 2009, "aol"] <- 1736700
ad_rev[ad_rev$year == 2010, "aol"] <- 1284100
ad_rev[ad_rev$year == 2011, "aol"] <- 1314200
ad_rev[ad_rev$year == 2012, "aol"] <- 1418500
ad_rev[ad_rev$year == 2013, "aol"] <- 1613400
ad_rev[ad_rev$year == 2009, "fb"] <- 0
ad_rev[ad_rev$year == 2010, "fb"] <- 1868000
ad_rev[ad_rev$year == 2011, "fb"] <- 3154000
ad_rev[ad_rev$year == 2012, "fb"] <- 4279000
ad_rev[ad_rev$year == 2013, "fb"] <- 6986000
ad_rev[ad_rev$year == 2009, "google_own"] <- 15723000
ad_rev[ad_rev$year == 2010, "google_own"] <- 19444000
ad_rev[ad_rev$year == 2011, "google_own"] <- 26145000
ad_rev[ad_rev$year == 2012, "google_own"] <- 31221000
ad_rev[ad_rev$year == 2013, "google_own"] <- 37453000
ad_rev[ad_rev$year == 2009, "google_aff"] <- 7166000
ad_rev[ad_rev$year == 2010, "google_aff"] <- 8792000
ad_rev[ad_rev$year == 2011, "google_aff"] <- 10386000
ad_rev[ad_rev$year == 2012, "google_aff"] <- 12465000
ad_rev[ad_rev$year == 2013, "google_aff"] <- 13125000
ad_rev$google <- ad_rev$google_own + ad_rev$google_aff
ad_rev_plot <- data.frame(Year = ad_rev$year, Yahoo = ad_rev$yahoo,
Google = ad_rev$google, Facebook = ad_rev$fb, AOL = ad_rev$aol)
library(reshape2)
ad_rev_melt <- melt(ad_rev_plot, id = "Year", measure.vars = c("Yahoo",
"Google",
"Facebook",
"AOL"))
colnames(ad_rev_melt)[2] <- "Company"
View(ad_rev_melt)
ad_rev_melt$value <- ad_rev_melt$value / 1000
View(ad_rev_melt)
library(plyr)
ad_rev_melt <- ddply(ad_rev_melt, .(Year), transform, percent = value/sum(value)*100)
ad_rev_melt <- ddply(ad_rev_melt, .(Year), transform, pos = (cumsum(value)-0.5*value))
ad_rev_melt$label <- paste0(sprintf("%.0f", ad_rev_melt$percent), "%")
library(ggplot2)
ggplot(data = ad_rev_melt, aes(x = Year, y = value, fill = Company)) +
geom_bar(stat = "identity") +
geom_text(aes(y = pos, label = label), size = 6) +
ylab("Advertising revenue (dollars in millions)") +
theme(text = element_text(size = 20))
revenue <- data.frame(year = seq(from = 1995, to = 2013, by = 1))
revenue$yahoo <- c(1620, 21490, 70450, 203270, 591786, 1110178, 717422, 953067,
1625097, 3574517, 5257668, 6425679, 6969274, 7208502, 6460315,
6324651, 4984199, 4986566, 4680380)
revenue$yahoo_growth[1] <- NA
View(revenue)
for (i in 1:(length(revenue$yahoo)-1)){
revenue$yahoo_growth[i+1] <- round(revenue$yahoo[i+1]/revenue$yahoo[i] - 1, 2)
}
View(revenue)
for (i in 1:(length(revenue$yahoo)-1)){
revenue$yahoo_growth[i+1] <- round((revenue$yahoo[i+1]/revenue$yahoo[i]-1)*100, 2)
}
View(revenue)
revenue[revenue$year == 2009, "google"] <- 23651000
revenue[revenue$year == 2010, "google"] <- 29321000
revenue[revenue$year == 2011, "google"] <- 37905000
revenue[revenue$year == 2012, "google"] <- 50175000
revenue[revenue$year == 2013, "google"] <- 59825000
revenue[revenue$year == 2004, "google"] <- 3189223
revenue[revenue$year == 2005, "google"] <- 6138560
revenue[revenue$year == 2006, "google"] <- 10604917
revenue[revenue$year == 2007, "google"] <- 16593986
revenue[revenue$year == 2008, "google"] <- 21795550
revenue[revenue$year == 2000, "google"] <- 19108
revenue[revenue$year == 2001, "google"] <- 86426
revenue[revenue$year == 2002, "google"] <- 439508
revenue[revenue$year == 2003, "google"] <- 1465934
revenue$google_growth <- NA
for (i in 6:(length(revenue$google)-1)){
revenue$google_growth[i+1] <- round((revenue$google[i+1]/revenue$google[i]-1)*100, 2)
}
revenue[revenue$year == 2008, "fb"] <- 272000
revenue[revenue$year == 2009, "fb"] <- 777000
revenue[revenue$year == 2010, "fb"] <- 1974000
revenue[revenue$year == 2011, "fb"] <- 3711000
revenue[revenue$year == 2012, "fb"] <- 5089000
revenue[revenue$year == 2013, "fb"] <- 7872000
revenue$fb_growth <- NA
for (i in 14:(length(revenue$fb)-1)){
revenue$fb_growth[i+1] <- round((revenue$fb[i+1]/revenue$fb[i]-1)*100, 2)
}
revenue[revenue$year == 2009, "aol"] <- 3245800
revenue[revenue$year == 2010, "aol"] <- 2416700
revenue[revenue$year == 2011, "aol"] <- 2202100
revenue[revenue$year == 2012, "aol"] <- 2191700
revenue[revenue$year == 2013, "aol"] <- 2319900
revenue[revenue$year == 2008, "aol"] <- 4152700
revenue[revenue$year == 2007, "aol"] <- 5180700
revenue[revenue$year == 2006, "aol"] <- 7786700
revenue[revenue$year == 2005, "aol"] <- 8202100
revenue$aol_growth <- NA
for (i in 11:(length(revenue$aol)-1)){
revenue$aol_growth[i+1] <- round((revenue$aol[i+1]/revenue$aol[i]-1)*100, 2)
}
library(reshape2)
revenueMelt <- melt(revenue, id = "year", measure.vars = c("yahoo_growth",
"google_growth",
"fb_growth",
"aol_growth"))
revenueMelt <- revenueMelt[!(revenueMelt$year %in% c(1995, 1996)),]
colnames(revenueMelt)[2] <- "Company"
levels(revenueMelt$Company) <- c("Yahoo", "Google", "Facebook", "AOL")
View(revenueMelt)
View(revenue)
library(ggplot2)
ggplot(data = revenueMelt, aes(x = year, y = value, group = Company,
shape = Company, color = Company)) +
geom_line(size = 1) +
geom_point(size = 3) +
scale_x_continuous(breaks = c(1997, 2001, 2005, 2009, 2013)) +
xlab("Year") +
ylab("Revenue growth (%)") +
theme(text = element_text(size = 20))
library(swirl)
swirl()
cor(gch_nor, gpa_nor)
l_nor <- lm(gch_nor ~ gpa_nor)
fit <- lm(child ~ parent, data = galton)
fit <- lm(child ~ parent, galton)
sigma <- sqrt(sum(fit$residuals^2) / (n-2))
sqrt(sum(fit$residuals^2) / (n-2))
summary(fit)$sigma
deviance(fit)/(n-2)
sqrt(deviance(fit)/(n-2))
mu <- mean(galton$child)
sTot <- sum((galton$child - mu) ^ 2)
sRes <- deviance(fit)
1 - sRes / sTot
summary(fit)$r.squared
cor(galton$child, galton$parent)^2
ones <- rep(1, nrow(galton))
lm(child ~ ones + parent -1, galton)
lm(child ~ parent, galton)
lm(child ~ 1, galton)
View(trees)
fit <- lm(Volume ~ Girth + Height + Constant -1, trees)
trees2 <- eliminate("Girth", trees)
head(trees2)
fit2 <- lm(Volume ~ Height + Constant -1, trees2)
lapply(list(fit, fit2), coef)
library("dplyr")
library("ggplot2")
library("nycflights13")
library("lubridate")
install.packages("nycflights13")
install.packages("lubridate")
library("nycflights13")
library("lubridate")
flights
class(flights)
weather
planes
airports
airlines
select(flights, year, month, day)
filter(flights, tailnum=="N14228")
mutate(flights, madeup=dep_delay-arr_delay)
summarize(flights, avgdelay=mean(arr_delay, na.rm=TRUE))
group_by(flights, dest)
summarize(group_by(flights, dest), avgdelay=mean(arr_delay, na.rm=TRUE))
select(
filter(
mutate(flights,
madeup=dep_delay-arr_delay
), madeup>60
), dep_delay, arr_delay, dest, madeup
)
flights
flights %>%
mutate(madeup=dep_delay-arr_delay) %>%
filter(madeup>60) %>%
select(dep_delay, arr_delay, dest, madeup)
flights <- flights %>%
mutate(date=ymd(paste(year, month, day, sep="-"))) %>%
na.omit()
flights
flights %>% select(date)
class(flights$date)
flights %>% group_by(date) %>% summarize(n=n())
flights %>% group_by(date, origin) %>% summarize(n=n())
flights %>% group_by(week(date), origin) %>% summarize(n=n())
flights %>% group_by(week=week(date), origin) %>% summarize(n=n())
byweek <- flights %>%
group_by(week=week(date), origin) %>%
summarize(n=n(), delay=mean(arr_delay), ndests=n_distinct(dest))
byweek
byweek %>% ggplot(aes(week, n, colour=origin)) + geom_line()
byweek %>% summarize(sum(n))
byweek %>%
filter(week<=52) %>%
ggplot(aes(week, n, colour=origin)) + geom_line()
ymd("2013-01-01") + weeks(21) # mem day
ymd("2013-01-01") + weeks(26) # july 4
ymd("2013-01-01") + weeks(35) # labor day. why JFK continues decline?
ymd("2013-01-01") + weeks(47)
byweek %>%
filter(week<=52) %>%
ggplot(aes(week, n, colour=origin)) + geom_line()
ymd("2013-01-01") + weeks(21) # mem day
ymd("2013-01-01") + weeks(26) # july 4
ymd("2013-01-01") + weeks(35) # labor day. why JFK continues decline?
ymd("2013-01-01") + weeks(47)
byweek %>%
filter(week<=52) %>%
ggplot(aes(week, ndests, colour=origin)) + geom_line()
flights
planes
flights %>%
inner_join(planes, by="tailnum") %>% # explain year.x, .y
group_by(year.y) %>%
summarize(delay=mean(arr_delay)) %>%
filter(!is.na(year.y)) %>%
ggplot(aes(year.y, delay)) + geom_point() + geom_smooth(method="loess")
flights %>%
group_by(month, origin) %>%
summarize(delay=mean(arr_delay)) %>%
ggplot(aes(month, delay, fill=origin)) + geom_bar(stat="identity", position="dodge")
delay_byday_byorigin <- flights %>%
group_by(date, origin) %>%
summarize(delay=mean(arr_delay))
delay_byday_byorigin
weather %>% group_by(year, month, day) %>%
summarize(precip = mean(precip)) %>%
na.omit() %>%
mutate(date=ymd(paste(year, month, day, sep="-"))) %>%
inner_join(delay_byday_byorigin, by="date") %>%
ggplot(aes(precip, delay, col=origin)) + geom_point() + geom_smooth()
flights %>% group_by(tailnum) %>%
summarize(dist=mean(distance), delay=mean(arr_delay), count=n()) %>%
ggplot(aes(dist, delay)) + geom_point(aes(size=count), alpha=1/2) + scale_size_area()
data(mtcars)
dim(mtcars)
names(mtcars)
mtcars$am <- as.factor(mtcars$am)
levels(mtcars$am) <- c("Automatic", "Manual")
sort(cor(mtcars)[1,])
t.test(mtcars$mpg ~ mtcars$am)
stepmodel <- step(lm(mpg ~ ., mtcars), trace = 0, steps = 10000)
summary(stepmodel)
?mtcars
plot(stepmodel)
data(mtcars)
names(mtcars)
sort(cor(mtcars)[1,])
mtcars$am <- as.factor(mtcars$am)
levels(mtcars$am) <- c("Automatic", "Manual")
t.test(mtcars$mpg ~ mtcars$am)
stepmodel <- step(lm(mpg ~ ., mtcars), trace = 0, steps = 10000)
summary(stepmodel)
confint(stepmodel)
library(caret)
setwd("~/personal/class/Cousera-Data Science Specialization/datasciencecoursera")
train <- read.csv("./data/train.csv", header = TRUE, na.strings = c("NA", ""))
test <- read.csv("./data/test.csv", header = TRUE, na.strings = c("NA", ""))
dim(train)
missing <- colSums(is.na(train))
unique(missing)
sum(missing == 19216)
train <- train[, missing == 0]
test <- test[, missing == 0]
dim(train)
names(train)
train <- train[, -c(1:7)]
names(test)
test <- test[, -c(1:7)]
is.numeric(train)
sapply(train, is.numeric)
sum(sapply(train[, -length(train)], is.numeric))
class(train$classe)
str(train$classe)
sum(sapply(train[, -"classe"], is.numeric))
sum(sapply(train, is.numeric))
length(train)
cor(train[, -length(train)])
findCorrelation(cor(train[, -length(train)]), cutoff = 0.5)
corVar <- findCorrelation(cor(train[, -length(train)]), cutoff = 0.5)
train <- train[, -corVar]
test <- test[, -corVar]
library(corrplot)
install.packages("corrplot")
library(corrplot)
corrplot(cor(train[, -length(train)]), method = "color", type = "lower",
ordeer = "hclust", t1.cex = 0.75, t1.col = "black", t1.srt = 45)
corrplot(cor(train[, -length(train)]), method = "color", type = "lower",
order = "hclust", t1.cex = 0.75, t1.col = "black", t1.srt = 45)
preProcess(train[, -length(train)], method = "pca", thresh = .99)
preProcess(train[, -length(train)], method = "pca", thresh = .95)
preProcess(train[, -length(train)], method = "pca", thresh = .90)
corrplot(cor(train[, -length(train)]), method = "circle")
corrplot(cor(train[, -length(train)]), method = "circle", type = "lower")
inTrain <- createDataPartition(train$classe, p = 0.7, list = FALSE)
trainSub <- train[inTrain,]
crossVal <- train[-inTrain,]
modFit <- train(classe ~ ., method = "rf", data = trainSub,
trControl = trainControl(method = "cv"), importance = TRUE)
varImpPlot(modFit$finalModel)
varImpPlot(modFit$finalModel, sort = TRUE, type = 1)
varImpPlot(modFit$finalModel, sort = TRUE, type = 1, pch = 19, col = "blue")
pred <- predict(modFit, crossVal)
confMat <- confusionMatrix(pred, crossVal$classe)
confMat$table
confMat$overall[[1]]
1-confMat$overall[[1]]
answers <- predict(modelFit, test)
answers <- predict(modFit, test)
answers
pml_write_files = function(x){
n = length(x)
for(i in 1:n){
filename = paste0("problem_id_",i,".txt")
write.table(x[i],file=filename,quote=FALSE,row.names=FALSE,col.names=FALSE)
}
}
if(!file.exists("answers")) {
dir.create("answers")
}
setwd("./answers")
pml_write_files(answers)
